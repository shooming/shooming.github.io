{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/Mongo-DB-6","result":{"data":{"markdownRemark":{"id":"cefe1dca-c998-51dd-8bef-99a46cff1d15","html":"<h1 id=\"mongodb-메모리-이슈\" style=\"position:relative;\"><a href=\"#mongodb-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EC%9D%B4%EC%8A%88\" aria-label=\"mongodb 메모리 이슈 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>mongoDB 메모리 이슈</h1>\n<p>이번 기업협업시 mongoDB를 사용하면서 mongoDB가 캐시메모리를 자꾸 늘려나가서 메모리를 계속 먹다보니 프로세스 관리자가 메모리 점유율이 가장높은 프로세스를 강제로 꺼버리는 이슈가 있었다. 아무래도 강제로 꺼지다 보니 monogoDB의 다른 오류들도 같이와서 다시 설치하고 다시 데이터를 넣는 고통을 겪었다.</p>\n<p>그래서 wiredTiger를 사용하여 memory 사용량을 제한하기로 하였다.</p>\n<h2 id=\"wiredtiger-설정\" style=\"position:relative;\"><a href=\"#wiredtiger-%EC%84%A4%EC%A0%95\" aria-label=\"wiredtiger 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>wiredTiger 설정</h2>\n<p><code class=\"language-text\">/etc/mongod.conf</code>에서 설정을 바꾸어 주기만하면되는 아주아주 간단한 작업이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">storage:\n    engine: <span class=\"token string\">\"wiredTiger\"</span>\n    directoryPerDB: <span class=\"token boolean\">true</span>\n    wiredTiger:\n        engineConfig:\n            cacheSizeGB: <span class=\"token number\">1</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n            directoryForIndexes: <span class=\"token boolean\">true</span> <span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span>\n            statisticsLogDelaySecs: <span class=\"token number\">0</span> <span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span>\n        collectionConfig:\n            blockCompressor: <span class=\"token string\">\"snappy\"</span> <span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span>\n        indexConfig:\n            prefixCompression: <span class=\"token boolean\">true</span> <span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p><code class=\"language-text\">mongod.conf</code>에서 storage 부분만 잘 봐주면된다.</p>\n<ol>\n<li>[1] : 캐시메모리 설정하는 부분이고 기본적으로는 시스템 메모리의 절반 or 1GB 할당 하면된다.</li>\n<li>[2] :  innodb<em>file</em>per_table한 기능</li>\n<li>[3] : wiredTiger 통계 정보 파일을 몇 초 만에 출력할지 설정하는 것으로 기본은 0이다.</li>\n<li>[4] : 압축방식을 정하는 설정으로 none, snappy, zlib이 있다.</li>\n<li>[5] : 기본 True. index 압축 여부</li>\n</ol>\n<p>여러가지 옵션이 있기는 하지만 사실 1번까지만 작성해도 캐시메모리를 지정해 줄 수 있다.</p>","fields":{"slug":"/posts/Mongo-DB-6","tagSlugs":["/tag/mongo-db/","/tag/til/"]},"frontmatter":{"date":"2020-06-13T23:00:00","description":"Mongo DB TIL 배운거 정리","tags":["Mongo DB","TIL"],"title":"Mongo DB Memory Setting TIL","socialImage":""}}},"pageContext":{"slug":"/posts/Mongo-DB-6"}}}