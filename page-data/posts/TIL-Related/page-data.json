{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/TIL-Related","result":{"data":{"markdownRemark":{"id":"2ee171e3-27a6-5a65-9305-33a4fd64d7f2","html":"<h1 id=\"selectrelated--prefetchrelated\" style=\"position:relative;\"><a href=\"#selectrelated--prefetchrelated\" aria-label=\"selectrelated  prefetchrelated permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Select<em>related / Prefetch</em>related</h1>\n<p>Django를 사용하다 보면 데이터 베이스에서 자료를 가져와야할 일이 매우 많을 것이다.\n그때마다 데이터베이스에 접속하게 된다면 불필요하게 많은 접속을 할 수도 있게된다.\n이때 select<em>related, prefetch</em>related를 사용하게 되면 한번 데이터베이스 접속으로 연결된 내용들을 가져와 캐쉬하여 데이터 베이스에 다시 접속하지 않아도 캐쉬된 자료를 사용하여 자료를 제공할 수 있기 때문이다.</p>\n<h2 id=\"select_related\" style=\"position:relative;\"><a href=\"#select_related\" aria-label=\"select_related permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Select_related</h2>\n<p>보통 정참조 혹은 셀렉트할 객체가 역참조하는 single objectt (one-to-one, many-to-one)인 경우에 사용한다고 되어 있다.\n아래 사용예시를 보면\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4aafcdcd7d8b414610e6ef3b7674e2a6/567ac/select_related1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.166666666666664%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAABGUlEQVQoz3WR626EIBCFfZy2Koh3boK663pp0qTb93+WnoHlX5uckAH95hyGrBsX43Zlt6b3vDYFH9+LHvooh/8UvvZveZet25eZHsrcB7Wii/VH6HVHu35cRGtFOzWdg+puimJC47zgMnsc38YRPOqbWy43n1ipHWVxvNb4Na0GBQSsrBQXOjuun3m5lNmkuRO8EKwD3A6emAC/1gSzSkHkbP2enM9p/gNmQYlX0ZkJwOcT9wQ5qnWaD9QQSAQJsGLJkwnENti+YDgjtl8uSc4x9uWTM+6Mn6JJLGKdszHUkmAYSpr2DZltGLi2GCE9XrI1IbOpGlLJJQ+3yPbrOSFnGJgn208fpo0tXgUOCBlVRlUyZwPMcfIL/H54yQmdQnkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/4aafcdcd7d8b414610e6ef3b7674e2a6/8ac56/select_related1.webp 240w,\n/static/4aafcdcd7d8b414610e6ef3b7674e2a6/d3be9/select_related1.webp 480w,\n/static/4aafcdcd7d8b414610e6ef3b7674e2a6/e46b2/select_related1.webp 960w,\n/static/4aafcdcd7d8b414610e6ef3b7674e2a6/f992d/select_related1.webp 1440w,\n/static/4aafcdcd7d8b414610e6ef3b7674e2a6/b45a4/select_related1.webp 1675w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/4aafcdcd7d8b414610e6ef3b7674e2a6/8ff5a/select_related1.png 240w,\n/static/4aafcdcd7d8b414610e6ef3b7674e2a6/e85cb/select_related1.png 480w,\n/static/4aafcdcd7d8b414610e6ef3b7674e2a6/d9199/select_related1.png 960w,\n/static/4aafcdcd7d8b414610e6ef3b7674e2a6/07a9c/select_related1.png 1440w,\n/static/4aafcdcd7d8b414610e6ef3b7674e2a6/567ac/select_related1.png 1675w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/4aafcdcd7d8b414610e6ef3b7674e2a6/d9199/select_related1.png\"\n          alt=\"select_related1\"\n          title=\"select_related1\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span>\n</br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/575c358980381c02c9e6def9bc773b5e/ec09f/select_related2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 23.333333333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsSAAALEgHS3X78AAAAoUlEQVQY042NbQ6DIBBEuUyt1g9AVgUWUKu09P4X6lL+NmmTl82EMPOYW1/WRTWvEjwfUSgnIYwQyssgbcdNL/JtB02U0HPTcc0mvS/20HgaF11I1j9mcxfKU/NDKIFGe0ErZpBIWxluGIb8W9vDrckTW5qWvWrgUquqUXRL+AqzPoLeqU9OMmN4wrLV7XS9wU+YwZjNeGBIJCfIXLfwT/kNGp48pZMNfl8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/575c358980381c02c9e6def9bc773b5e/8ac56/select_related2.webp 240w,\n/static/575c358980381c02c9e6def9bc773b5e/d3be9/select_related2.webp 480w,\n/static/575c358980381c02c9e6def9bc773b5e/e46b2/select_related2.webp 960w,\n/static/575c358980381c02c9e6def9bc773b5e/f992d/select_related2.webp 1440w,\n/static/575c358980381c02c9e6def9bc773b5e/3d7de/select_related2.webp 1916w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/575c358980381c02c9e6def9bc773b5e/8ff5a/select_related2.png 240w,\n/static/575c358980381c02c9e6def9bc773b5e/e85cb/select_related2.png 480w,\n/static/575c358980381c02c9e6def9bc773b5e/d9199/select_related2.png 960w,\n/static/575c358980381c02c9e6def9bc773b5e/07a9c/select_related2.png 1440w,\n/static/575c358980381c02c9e6def9bc773b5e/ec09f/select_related2.png 1916w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/575c358980381c02c9e6def9bc773b5e/d9199/select_related2.png\"\n          alt=\"select_related2\"\n          title=\"select_related2\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>위 내용은 현재 하고 있는 프로젝트애서 related fetch를 사용한 방법과 사용하지 않은 방법이다.</p>\n<p>첫번째 경우를 보면 db에 한번 접속한것만으로도 값을 출력하지만\n두번째 경우에는 불러올때마다 쿼리가 발생함을 알 수 있다.</p>\n<p><code class=\"language-text\">select_related(&#39;참조할 테이블명__더 참조할 테이블&#39;)</code>을 사용하여 작성하며, <code class=\"language-text\">__테이블</code>을 사용하면 참조할 테이블을 타고 다음 테이블로 넘어가서 그 테이블도 캐시한다.</p>\n<h2 id=\"prefetch_related\" style=\"position:relative;\"><a href=\"#prefetch_related\" aria-label=\"prefetch_related permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Prefetch_related</h2>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c48be20c6a8860da61b81d0842253cbc/951a4/Prefetch_related.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 36.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAIAAACHqfpvAAAACXBIWXMAAAsSAAALEgHS3X78AAABAklEQVQY0z2QCXKFIBBEvVCisorsyPLX+H/uf5g0mqSqa2qg6HnTDDE/wvaw4ap0WXRWpqLXrq624YYvgXI/U4cqljgS/Tmv0EjMx7QO7fpd2gvy8bYavI5M+pk5wj0VAUfC3cwszExGNBMxIzXToaFc3lvdc3tp106BjBXkuqFqW6VKXEahEnouA/uX8H/mujuQbYUBAvOE4zVohxwTgYBMzXlE7eaYn6XtSAiaMsX4i1QbUKjqN0gno4efih6H9lB+ADaVr3p5+3SDuRt0xlaISnpO0NwJh2eiFl+FeoYfctvDdg/pzlXqv62zcQ1ThNpQEYQvCSNAXm3BCge8j8blD3wdYnttivzrAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/c48be20c6a8860da61b81d0842253cbc/8ac56/Prefetch_related.webp 240w,\n/static/c48be20c6a8860da61b81d0842253cbc/d3be9/Prefetch_related.webp 480w,\n/static/c48be20c6a8860da61b81d0842253cbc/e46b2/Prefetch_related.webp 960w,\n/static/c48be20c6a8860da61b81d0842253cbc/d1c11/Prefetch_related.webp 1355w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/c48be20c6a8860da61b81d0842253cbc/8ff5a/Prefetch_related.png 240w,\n/static/c48be20c6a8860da61b81d0842253cbc/e85cb/Prefetch_related.png 480w,\n/static/c48be20c6a8860da61b81d0842253cbc/d9199/Prefetch_related.png 960w,\n/static/c48be20c6a8860da61b81d0842253cbc/951a4/Prefetch_related.png 1355w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/c48be20c6a8860da61b81d0842253cbc/d9199/Prefetch_related.png\"\n          alt=\"Prefetch_related2\"\n          title=\"Prefetch_related2\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>위 내용은 Prefetch<em>related를 사용하여 Exterior테이블을 역참조하여 code값을 가져온 내용이다.\nPrefetch</em>related를 사용하면 위와같이 정참조가 아니어도 값의 추출이 가능하다.\n<code class=\"language-text\">Prefetch_related(&#39;참조할 테이블명_set&#39;)</code>을 사용하여야한다. 참조할 테이블명은 소문자로 작성하여야하며 _set을 붙여주자.</p>\n<p>보통은 위 방법들이 정참조, 역참조 관계에 딱 나뉘어져 사용한다고 되어있으나 상황에 맞추어 성능을 고려하여 필요한 것을 사용해 주도록 하자.</p>","fields":{"slug":"/posts/TIL-Related","tagSlugs":["/tag/select-related-prefetch-related/","/tag/django/","/tag/til/"]},"frontmatter":{"date":"2020-04-26T23:00:00","description":"MySql TIL 배운거 정리","tags":["Select_related / Prefetch_related","Django","TIL"],"title":"Select_related / Prefetch_related TIL","socialImage":""}}},"pageContext":{"slug":"/posts/TIL-Related"}}}